#include <stdio.h>
#include <stdint.h>

// Function to perform DES encryption
void des_encrypt(uint64_t plaintext, uint64_t key, uint64_t *ciphertext) {
    // Initialize variables
    uint64_t left, right, temp;
    int i;

    // Split plaintext into left and right halves
    left = plaintext >> 32;
    right = plaintext & 0xFFFFFFFF;

    // Perform 16 rounds of encryption
    for (i = 0; i < 16; i++) {
        // Perform substitution and permutation on right half
        temp = right;
        right = (right >> 4) ^ (right & 0xF);
        right = (right >> 2) ^ (right & 0x3);
        right = (right >> 1) ^ (right & 0x1);

        // XOR left half with key and right half
        left ^= key;
        left ^= right;

        // Swap left and right halves
        temp = left;
        left = right;
        right = temp;
    }

    // Combine left and right halves to form ciphertext
    *ciphertext = (left << 32) | right;
}

// Function to perform DES decryption
void des_decrypt(uint64_t ciphertext, uint64_t key, uint64_t *plaintext) {
    // Initialize variables
    uint64_t left, right, temp;
    int i;

    // Split ciphertext into left and right halves
    left = ciphertext >> 32;
    right = ciphertext & 0xFFFFFFFF;

    // Perform 16 rounds of decryption
    for (i = 0; i < 16; i++) {
        // Perform substitution and permutation on left half
        temp = left;
        left = (left >> 4) ^ (left & 0xF);
        left = (left >> 2) ^ (left & 0x3);
        left = (left >> 1) ^ (left & 0x1);

        // XOR right half with key and left half
        right ^= key;
        right ^= left;

        // Swap left and right halves
        temp = left;
        left = right;
        right = temp;
    }

    // Combine left and right halves to form plaintext
    *plaintext = (left << 32) | right;
}

int main() {
    uint64_t plaintext = 0x1234567890abcdef;
    uint64_t key = 0x0000000000000001;
    uint64_t ciphertext, decrypted_text;

    printf("Plaintext: 0x%016llx\n", plaintext);
    printf("Key: 0x%016llx\n", key);

    des_encrypt(plaintext, key, &ciphertext);
    printf("Ciphertext: 0x%016llx\n", ciphertext);

    des_decrypt(ciphertext, key, &decrypted_text);
    printf("Decrypted Text: 0x%016llx\n", decrypted_text);

    return 0;
}
